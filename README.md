# CmpInf - Replacement for SteelSeries System Monitor App  
  
## What's this?

### CmpInf?    
CmpInf is an application designed to work with the SteelSeries GameSense GG software. It includes and uses [LibreHardwareMonitorLib](https://github.com/LibreHardwareMonitor/LibreHardwareMonitor) to retrieve system information such as CPU temperature and GPU usage. This data is then sent to the GameSense GG software, which displays the **C**o**mp**uter **Inf**ormations on the keyboard’s OLED display.  
  
### Why?  
I noticed that one of the reasons I originally bought the keyboard has been removed. According to SteelSeries, they are addressing a security issue related to how the original System Monitor gathered system information.  
In our case, we use LibreHardwareMonitorLib, which — as far as I know — relies on the same (still unpatched) Ring0 driver. However, I believe the attack surface in this application is much smaller than with the System Monitor that ships with GG, since we do not run as admin by default and do not expose any interfaces to the outside.   
**Netherless be warned and try to avoid running this tool as administrator.** 


https://github.com/user-attachments/assets/8693f539-4208-47f7-9fca-ced591f6035d



### How?
As for now this project _(out of this README)_ is **fully** generated with GitHub CoPilot, so please take it with a grain of salt and feel free to raise an issue or PR to make it a bit better.

## How to install  

### What do you need?  
- [SteelSeries GG](https://steelseries.com/gg) installed and running (consider to put it into autostart)
- [Download](https://github.com/TBSniller/cmpinf/releases/latest) the latest release of CmpInf and run it

## How to use
### First start  
The application will copy itself to `%AppData%\CmpInf_SteelSeriesOledPcInfo` and will ask you to create a shortcut on your desktop. After start you will see a small [icon](https://github.com/TBSniller/cmpinf/blob/main/cmpinf_icon.ico) in your tray menu. 
In the AppData folder you will find a autogenerated `available-sensors.json` file, which contains all sensors that were found by LibreHardwareMonitorLib and can be used for your display.  

### Settings 
You can open the settings by right-clicking the tray icon and selecting "Settings". Here you can open the `settings.json` and configure your sensors and refresh timings. You can also control how long a page will be displayed if you define more than one.    
Global:  
- `UpdateIntervalMs`: Set the interval in milliseconds how often the sensors should be updated
- `GameSenseRetryIntervalMs`: Set the interval in milliseconds how often a reconnect will be attempted if the GameSense GG software is not available
- `GameSenseHeartbeatIntervalMs`: Set the interval in milliseconds how often a heartbeat will be sent to the GameSense GG software, when no sensor was updated
- `RunAsAdmin`: Set to `true` if you want to run the application as administrator
  
Pages:  
- `DurationMs`: Set the duration in milliseconds how long a page should be displayed
- `IconId`: Set the [icon id](https://github.com/SteelSeries/gamesense-sdk/blob/master/doc/api/event-icons.md) of the page, which will be displayed on the OLED display
  
Sensors:  
- `Name`, `Hardware`, `Type`: Need to be exacty extracted from the `available-sensors.json` file. It's the filteruery to find the sensor in the LibreHardwareMonitorLib
- `Prefix`: Set characters which will be displayed before the sensor value
- `Suffix`: Set characters which will be displayed after the sensor value
- `DecimalPlaces`: Set the number of decimal places which should be displayed for the sensor value
- `KeyInstance`: Set the key instance which will be used to display the sensor value on the OLED display. More internal value - it is used to identify the sensor in the GameSense GG software

### Autostart
You can enable autostart by right-clicking the tray icon and selecting "Settings". Here you can enable the autostart option, which depending on the permission level will run in
1. **User mode**: Creates a shortcut in your startup folder (`%AppData%\Microsoft\Windows\Start Menu\Programs\Startup`), so the application will be started automatically with *user rights*
2. **Admin mode**: Creates a scheduled task which will start the application with *administrator rights* on every system start. This is required if you want to read sensors which require administrator rights (e.g. CPU temperature).

### Logs
You can click on the Tray Icon or right-click it and select "Open" to open the log window and enable debug logs.  

### Uninstall
You can uninstall the application by right-clicking the tray icon and selecting "Uninstall" in settings. This will remove the application from your system and delete the AppData folder on the next reboot. If you have enabled autostart, it will also remove the shortcut or scheduled task.  

## Other

### Troubleshooting
If you see a `-` as sensor value, it means that LibreHardwareMonitorLib was not able to read the sensor value. This can happen if administrator rights are required to read the sensor value. You can try to run the application as administrator (Right-click on the tray icon -> Settings -> Run as administrator).  
  
### Known issues  
No issues are known so far, if you find one, feel free to raise an issue!  
  

### Credits
- [LibreHardwareMonitorLib](https://github.com/LibreHardwareMonitor/LibreHardwareMonitor) for sensor data <3  
- [Newtonsoft.Json](https://github.com/JamesNK/Newtonsoft.Json) for easy JSON handling <3  
- [SteelSeries GameSense SDK](https://github.com/SteelSeries/gamesense-sdk) for easy API usage <3  

### Screenshots
![apex_oled](https://github.com/user-attachments/assets/6b01f38c-4522-4ba7-840b-92c0a722ffbe)  
![image](https://github.com/user-attachments/assets/d86b7ce4-732f-4fcd-aed3-c7242c3ec867)  
![image](https://github.com/user-attachments/assets/f2978d14-ab04-45c2-81b4-ece9565551ba)  
